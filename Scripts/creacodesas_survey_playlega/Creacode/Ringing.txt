EVENT CallRinging()
{
    LOG("Creacode-> Ringing:: CallRinging in Ringing is interpreting");
    //g_PlayingRinging = TRUE;
    //PlayBackgroundAudio(_LEG_A_, "Ringing", TRUE, 2);
    LOG("Creacode-> Ringing:: CallRinging is ENDED");
}

EVENT CallRingingWithMedia()
{
    LOG("CallRingingWithMedia in Ringing is interpreting");
}

EVENT CallAnswered()
{
    LOG("Creacode-> Ringing:: CallAnswered in Ringing is interpreting");
    if (g_PlayingRinging == TRUE)
    {
        g_PlayingRinging = FALSE;
        StopBackgroundAudio(_LEG_A_);
    }
    
    CloseAudioChannel(_LEG_A_);
    JoinLegs(_LEG_B_, _LEG_A_);

    RunScript("Creacode\\CallMonitor.txt");
}

EVENT CallReject()
{
    LOG("Creacode-> Ringing:: CallReject in Ringing is interpreting");
    LOG("Creacode-> Ringing:: Reject Cause: " + i2str(_RESPONSE_));

    if (g_PlayingRinging == TRUE)
    {
        g_PlayingRinging = FALSE;
        StopBackgroundAudio(_LEG_A_);
    }
    
    if (_RESPONSE_ == 404) {
        LOG("Creacode-> Ringing:: Called number is not found");
        //PlayAudio(_LEG_A_, "invalidno");
    }
    if (_RESPONSE_ == 486) {
        LOG("Creacode-> Ringing:: Called number is busy");

    }
    if ((_RESPONSE_ == 408) || (_RESPONSE_ == 480) || (_RESPONSE_ == 484) || (_RESPONSE_ == 487)) {
        LOG("Creacode-> Ringing:: Called number does not answer");

    }
    if (_RESPONSE_ == 500) {
        LOG("Creacode-> Ringing:: Interval Server Error (Sip Cause 500)");

    }

    //RadiusStopAccounting();
    AbortSession();
}

EVENT CallEnd()
{
    LOG("Creacode-> Ringing:: CallEnd in Ringing is interpreting");
    if (g_PlayingRinging == TRUE) {
        StopBackgroundAudio(_LEG_A_);
    }

    //RadiusStopAccounting();
    CloseSession();
}